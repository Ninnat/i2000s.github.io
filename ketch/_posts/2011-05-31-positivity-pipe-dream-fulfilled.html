---
layout: post
name: positivity-pipe-dream-fulfilled
title: The positivity pipe dream fulfilled?
time: 2011-05-31 10:35:00.000000000 +03:00
tags: numerical-analysis positivity SSP hyperbolic-PDEs mathematical-exposition
---
This post is about my <a href="http://arxiv.org/abs/1105.5798">recently accepted SINUM paper</a>.  This is an attempt to provide a broad context for the paper and related work in a less formal way, which couldn't be included in a journal publication.<br /><br />In 1979, Bolley and Crouzeix published a fairly astonishing result (<a href="http://archive.numdam.org/article/M2AN_1978__12_3_237_0.pdf">in French here</a>).  Namely, they showed that, for linear differential equations whose solution is always positive, it is <b>impossible</b> to design numerical methods that always yield a <b>positive</b> solution under <b>arbitrarily large</b> step sizes, even if one considers the very broad class of ODE solvers known as general linear methods.  The <b>only</b> exception to this statement is the backward Euler method, which has many nice properties but is, unfortunately, too inaccurate for most applications.  <br /><br />This result stands in stark contrast to corresponding results on, say, stability in inner-product norms, where use of implicit methods can get you <b>unconditional</b> stability even for nonlinear problems.<br /><br />I'm speaking roughly here, and won't attempt to be more precise (go read the paper if you want details).  But the motivation cited by Bolley and Crouzeix for looking at this question was the idea that one might be able <b>to take large time steps and maintain positivity in the solution of hyperbolic problems</b>.  Unfortunately, their result showed that this was not possible unless one was willing to settle for first-order accuracy.<br /><br />What this result didn't indicate is <b>how large</b> the positivity-preserving step size could be for an implicit method.  This question was partially answered within a decade, by <a href="http://www.jstor.org/pss/2008536">Lenferink</a> and by <a href="http://www.springerlink.com/content/t3x7154136486u46/">van de Griend & Kraaijevanger</a>, for linear multistep methods and for Runge-Kutta methods, respectively.  In both cases they found that the largest positivity-preserving step size was <b>no more than two times</b> the step size allowed by using the forward Euler method.<br /><br />Of course, an implicit solve costs significantly more than an explicit solve, so gaining only a factor of two in the step size just isn't worth it.  I don't know of any more work that was done on this problem after 1991 until fairly recently, in two of <a href="http://www.amath.washington.edu/~ketch/David_Ketcheson/ketcheson2008c.html">my own</a> <a href="http://linkinghub.elsevier.com/retrieve/pii/S0168927408000688">papers</a>.  The results there are consistent with the apparent barrier of a 2X step size, although see my short note at the end.<br /><br />In one attempt to circumvent this bound, <a href="http://people.maths.ox.ac.uk/~macdonald/dsrk.pdf">Gottlieb, Macdonald & Ruuth</a> investigated the class of diagonally split Runge-Kutta methods (which aren't general linear methods, so escape the implications of Bolley & Crouzeix).  They did find higher order methods with unconditional strong stability properties, but the accuracy of these methods invariably reduced to <b>first order</b> when used with large timesteps!  It seemed that any effort to find unconditionally positive methods would be thwarted one way or another.<br /><br />This sets the stage for my recently accepted SINUM paper.  In this paper I found that by using both upwind-biased and downwind-biased discretizations (an idea that goes all the way back to <a href="http://link.aip.org/link/?SJOCE3/9/1073/1">Shu's original paper on "TVD time discretizations"</a>) in implicit Runge-Kutta methods, one can obtain second-order accurate methods that preserve positivity under arbitrarily large step sizes -- and they have this property even when applied to nonlinear problems.  Remarkably, the methods appear to give quite accurate results when applied to problems with shocks.<br /><br />It seems that we have gotten around the 2X barrier at last!  But important issues remain, most notably the efficient implementation of these "implicit downwind Runge-Kutta schemes" in combination with high order hyperbolic PDE discretizations (like WENO).<br /><br />I must reiterate that I've glossed over several important technical points here.  For more details, go read the paper.<br /><br />Note 1: In my Ph.D. thesis, I did find a method that breaks the 2X barrier, but only just barely and only for linear problems.<br /><br />Note 2: I've referred rather carelessly in this post to literature on positivity preservation, contractivity, and strong stability preservation (monotonicity) without distinguishing between the three, simply because the conditions on the method turn out to be the same.  The articles mentioned generally focus on one property or the other, but the results almost always carry over to all three.<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/4660225022390848760-5076635724936855401?l=scienceinthesands.blogspot.com' alt='' /></div>
